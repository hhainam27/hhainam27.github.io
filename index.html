<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Random Manga Redirect</title>
  <style>
    body {
      background: #0f0f0f;
      color: #fff;
      font-family: sans-serif;
      text-align: center;
      padding-top: 20vh;
    }
    h1 {
      color: #f472b6;
      text-shadow: 0 0 10px #f472b6;
    }
    button {
      padding: 1em 2em;
      font-size: 1rem;
      cursor: pointer;
      background-color: #f472b6;
      color: white;
      border: none;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(244,114,182,0.5);
    }
  </style>
</head>
<body>
  <h1>üé≤ ƒêang ch·ªçn manga ng·∫´u nhi√™n...</h1>
  <p>N·∫øu l√¢u, vui l√≤ng nh·∫•n n√∫t b√™n d∆∞·ªõi:</p>
  <button id="retryBtn" style="display:none;">Ch·ªçn l·∫°i</button>

  <script>
    async function randomRedirect() {
      try {
        const proxy = "https://corsproxy.io/?url=";
        const apiUrl = encodeURIComponent("https://cuutruyen.net/api/v2/teams/1/mangas/recently_updated?page=1&per_page=50");
        const res = await fetch(proxy + apiUrl);
        if (!res.ok) throw new Error("HTTP error " + res.status);
        const json = await res.json();

        if (!Array.isArray(json.data) || json.data.length === 0) throw new Error("No manga data");

        const random = json.data[Math.floor(Math.random() * json.data.length)];
        const url = `https://cuutruyen.net/mangas/${random.id}`;

        const a = document.createElement("a");
        a.href = url;
        a.target = "_blank";
        a.rel = "noopener noreferrer";
        document.body.appendChild(a);
        a.click();
        a.remove();

        // Fallback n·∫øu popup b·ªã ch·∫∑n
        setTimeout(() => {
          window.location.href = url;
        }, 300);
      } catch (err) {
        console.error("‚ùå Error fetching page:", err);
        document.body.innerHTML = '<h2 style="color: red; text-align: center;">Kh√¥ng th·ªÉ t·∫£i danh s√°ch manga</h2>';
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      const btn = document.getElementById("retryBtn");
      btn.addEventListener("click", () => location.reload());
      randomRedirect();
    });
  </script>
</body>
</html>
